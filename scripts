results <- read.table("DESeq2_result.tabular", header=TRUE, sep="\t", row.names=1)
results$significance <- "Not Significant"
results$significance[results$padj < 0.05 & results$log2FoldChange > 1] <- "Upregulated"
results$significance[results$padj < 0.05 & results$log2FoldChange < -1] <- "Downregulated"
library(ggplot2)
ggplot(results, aes(x=log2FoldChange, y=-log10(padj), color=significance)) +
  geom_point(alpha=0.6, size=1.5) +
  scale_color_manual(values=c("red", "gray", "blue")) +
  theme_minimal() +
  labs(title="Volcano Plot: Stress vs Control",
       x="log2 Fold Change",
       y="-log10 Adjusted p-value")
